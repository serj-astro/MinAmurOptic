document.getElementById("happy").onchange=function(){1==this.checked|1==happy3.checked?(document.getElementById("happy3").disabled=!0,document.getElementById("order_recip").disabled=!1,document.getElementById("order_adr").disabled=!1,document.getElementById("order_adr").focus()):(document.getElementById("happy3").disabled=!1,document.getElementById("order_recip").disabled=!0,document.getElementById("order_adr").disabled=!0)},document.getElementById("happy3").onchange=function(){1==this.checked|1==happy.checked?(document.getElementById("happy").disabled=!0,document.getElementById("order_recip").disabled=!1,document.getElementById("order_adr").disabled=!1,document.getElementById("order_adr").focus()):(document.getElementById("happy").disabled=!1,document.getElementById("order_recip").disabled=!0,document.getElementById("order_adr").disabled=!0)},document.addEventListener("DOMContentLoaded",(()=>{const e=()=>{const e=document.querySelector('input[name="type"]:checked'),t=document.querySelector('input[name="prezent"]:checked'),n=document.querySelector('input[name="bistro"]:checked'),a=document.querySelector('input[name="post_nal"]:checked'),r=document.querySelector('input[name="summ"]'),o=document.querySelector('input[name="discount"]'),u=document.querySelector(".discount");let l=0,c=0,d=0,m=/[^а-яёА-ЯЁ\-\. ]/g;if("pers"==e.value){const e=document.querySelector('*[name="pers_name"]'),t=document.querySelector('*[name="pers_birthday"]'),n=document.querySelector('*[name="pers_time"]'),a=document.querySelector('*[name="pers_location"]');(m.test(e.value)||e.value.length<2||10!=t.value.length||5!=n.value.length||m.test(a.value)||a.value.length<2)&&(d=1)}if("group"==e.value){const e=document.querySelector('*[name="group_first_name"]'),t=document.querySelector('*[name="group_first_birthday"]'),n=document.querySelector('*[name="group_first_time"]'),a=document.querySelector('*[name="group_first_location"]'),r=document.querySelector('*[name="group_second_name"]'),o=document.querySelector('*[name="group_second_birthday"]'),u=document.querySelector('*[name="group_second_time"]'),l=document.querySelector('*[name="group_second_location"]');(m.test(e.value)||e.value.length<2||10!=t.value.length||5!=n.value.length||m.test(a.value)||a.value.length<2||m.test(r.value)||r.value.length<2||10!=o.value.length||5!=u.value.length||m.test(l.value)||l.value.length<2)&&(d=1)}if("biz"==e.value){const e=document.querySelector('*[name="biz_name"]'),t=document.querySelector('*[name="biz_birthday"]'),n=document.querySelector('*[name="biz_time"]'),a=document.querySelector('*[name="biz_location"]'),r=document.querySelector('*[name="biz_event_name"]'),o=document.querySelector('*[name="biz_event_date"]'),u=document.querySelector('*[name="biz_event_time"]'),l=document.querySelector('*[name="biz_event_location"]');(m.test(e.value)||e.value.length<2||10!=t.value.length||5!=n.value.length||m.test(a.value)||a.value.length<2||m.test(r.value)||r.value.length<2||10!=o.value.length||5!=u.value.length||m.test(l.value)||l.value.length<2)&&(d=1)}if(0==d){let r=0;if("pers"==e.value){const e=document.querySelector('input[name="pers_birthday"]');if(""!=e.value){const t=new Date(e.value),n=new Date,a=new Date(t.getMonth()+1+"/"+t.getDate()+"/"+n.getFullYear()).getTime()-n.getTime(),u=Math.ceil(a/864e5);u<=10&&u>0&&o&&o.value>0&&(r=o.value)}}if("group"==e.value){const e=document.querySelector('input[name="group_first_birthday"]'),t=document.querySelector('input[name="group_second_birthday"]');if(""!=e.value){const t=new Date(e.value),n=new Date,a=new Date(t.getMonth()+1+"/"+t.getDate()+"/"+n.getFullYear()).getTime()-n.getTime(),u=Math.ceil(a/864e5);u<=10&&u>0&&o&&o.value>0&&(r=o.value)}if(""!=t.value){const e=new Date(t.value),n=new Date,a=new Date(e.getMonth()+1+"/"+e.getDate()+"/"+n.getFullYear()).getTime()-n.getTime(),u=Math.ceil(a/864e5);u<=10&&u>0&&o&&o.value>0&&(r=o.value)}}if("biz"==e.value){const e=document.querySelector('input[name="biz_birthday"]');if(""!=e.value){const t=new Date(e.value),n=new Date,a=new Date(t.getMonth()+1+"/"+t.getDate()+"/"+n.getFullYear()).getTime()-n.getTime(),u=Math.ceil(a/864e5);u<=10&&u>0&&o&&o.value>0&&(r=o.value)}}if(e){let t=parseInt(e.dataset.price);r>0&&(t-=t/100*r),l+=t,c+=parseInt(e.dataset.price)}if(t&&n&&!a?l+=parseInt(t.dataset.price)+parseInt(n.dataset.price):t||n||!a?n&&a&&!t?l=parseInt(a.dataset.price)+parseInt(n.dataset.price)/100*70:!n||a||t?!t||n||a||(l+=parseInt(t.dataset.price)):l+=parseInt(n.dataset.price)/100*50:l=parseInt(a.dataset.price),r>0){let e="";a?(e="Сумма к оплате на почте "+(c-c/100*r)+" руб.<br>",e=e+"Скидка в День рождения "+r+"%.<br>Полная стоимость без скидки "+(l+c)+" руб."):e=e+"Скидка в День рождения "+r+"%.<br>Полная стоимость без скидки "+c+" руб.",u.innerHTML=e}else u.innerHTML="",a&&(u.innerHTML="Сумма к оплате на почте "+c+" руб.")}r.value=l},t=t=>{t.preventDefault();const n=t.target,a=document.querySelector(".tab__content-show");a&&a.classList.remove("tab__content-show");const r=document.getElementById(n.value);r&&r.classList.add("tab__content-show"),e()};e();document.querySelectorAll('input[name="type"]').forEach((e=>{e.addEventListener("change",t)}));document.querySelectorAll("#eform input").forEach((t=>{t.addEventListener("keyup",e)})),document.querySelector('input[name="type"]').addEventListener("change",e),document.querySelector('input[name="prezent"]').addEventListener("change",e),document.querySelector('input[name="bistro"]').addEventListener("change",e),document.querySelector('input[name="post_nal"]').addEventListener("change",e)})),document.addEventListener("DOMContentLoaded",(()=>{const e=e=>{e.preventDefault();let t=new FormData(e.target);const n=e.target.querySelector('button[type="submit"]'),a=document.getElementsByClassName("header__pers");for(let e=0;e<a.length;++e){a[e].classList.remove("error");let t=a[e].querySelector("span");t&&(t.innerHTML="")}let r=new XMLHttpRequest;n.disabled=!0,n.innerHTML="Подождите...",r.open("POST","/pay.php"),r.send(t),r.onload=function(){if(200==r.status){let e=JSON.parse(r.response);e.success?void 0!==e.link&&(location.href=e.link):e.errors?Object.keys(e.errors).forEach((t=>{const n=document.querySelector('*[name="'+t+'"]'),a=n.parentNode.querySelector("span");n&&n.parentNode.classList.add("error"),a&&(a.innerHTML=e.errors[t])})):alert(e.error)}else alert("Возникла ошибка при запросе.");n.disabled=!1,n.innerHTML="Оплатить"}},t=document.getElementById("eform");t&&t.addEventListener("submit",e)}));